<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Mileage Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1, h2 {
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .form-section, .log-section, .monthly-section {
            background: #f9f9f9;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="date"], input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .total-mileage {
            font-weight: bold;
            font-size: 1.2em;
        }
        .export-btn {
            background-color: #008CBA;
        }
        .export-btn:hover {
            background-color: #007B9E;
        }
    </style>
    <!-- jsPDF and html2pdf.js libraries for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>

    <div class="container" id="mileage-log">
        <h1>Business Mileage Tracker</h1>

        <div class="form-section">
            <h2>Add New Trip</h2>
            <form id="trip-form">
                <label for="date">Date:</label>
                <input type="date" id="date" required>

                <label for="purpose">Purpose of Trip:</label>
                <input type="text" id="purpose" placeholder="e.g., Client Meeting" required>

                <label for="startOdometer">Start Odometer:</label>
                <input type="number" id="startOdometer" placeholder="e.g., 50000" required>

                <label for="endOdometer">End Odometer:</label>
                <input type="number" id="endOdometer" placeholder="e.g., 50100" required>

                <button type="submit">Add Trip</button>
            </form>
        </div>

        <div class="log-section">
            <h2>Trip Log</h2>
            <table id="trip-log">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Purpose</th>
                        <th>Start Odometer</th>
                        <th>End Odometer</th>
                        <th>Distance (Miles)</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Trip entries will be added here -->
                </tbody>
            </table>
            <p class="total-mileage">Total Business Mileage: <span id="total-mileage">0</span> Miles</p>
        </div>

        <div class="monthly-section">
            <h2>Monthly Odometer Readings</h2>
            <form id="monthly-form">
                <label for="month">Month:</label>
                <input type="month" id="month" required>

                <label for="monthlyStartOdometer">Starting Odometer for the Month:</label>
                <input type="number" id="monthlyStartOdometer" placeholder="e.g., 50000" required>

                <label for="monthlyEndOdometer">Ending Odometer for the Month:</label>
                <input type="number" id="monthlyEndOdometer" placeholder="e.g., 52000" required>

                <button type="submit">Add Monthly Reading</button>
            </form>
            <table id="monthly-log">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Start Odometer</th>
                        <th>End Odometer</th>
                        <th>Total Monthly Miles</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Monthly entries will be added here -->
                </tbody>
            </table>
        </div>

        <button class="export-btn" id="export-pdf">Export to PDF</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tripForm = document.getElementById('trip-form');
            const tripLogBody = document.querySelector('#trip-log tbody');
            const totalMileageEl = document.getElementById('total-mileage');

            const monthlyForm = document.getElementById('monthly-form');
            const monthlyLogBody = document.querySelector('#monthly-log tbody');

            let trips = JSON.parse(localStorage.getItem('mileageTrips')) || [];
            let monthlyReadings = JSON.parse(localStorage.getItem('monthlyReadings')) || [];

            const calculateTotalMileage = () => {
                const total = trips.reduce((acc, trip) => acc + trip.distance, 0);
                totalMileageEl.textContent = total;
            };

            const renderTrips = () => {
                tripLogBody.innerHTML = '';
                trips.forEach((trip, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${trip.date}</td>
                        <td>${trip.purpose}</td>
                        <td>${trip.start}</td>
                        <td>${trip.end}</td>
                        <td>${trip.distance}</td>
                        <td>
                            <button onclick="editTrip(${index})">Edit</button>
                            <button onclick="deleteTrip(${index})">Delete</button>
                        </td>
                    `;
                    tripLogBody.appendChild(row);
                });
                calculateTotalMileage();
            };

            const renderMonthlyReadings = () => {
                monthlyLogBody.innerHTML = '';
                monthlyReadings.forEach(reading => {
                    const row = document.createElement('tr');
                    const totalMonthlyMiles = reading.end - reading.start;
                    row.innerHTML = `
                        <td>${reading.month}</td>
                        <td>${reading.start}</td>
                        <td>${reading.end}</td>
                        <td>${totalMonthlyMiles}</td>
                    `;
                    monthlyLogBody.appendChild(row);
                });
            };

            tripForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const date = document.getElementById('date').value;
                const purpose = document.getElementById('purpose').value;
                const start = parseInt(document.getElementById('startOdometer').value);
                const end = parseInt(document.getElementById('endOdometer').value);

                if (end < start) {
                    alert('End odometer reading cannot be less than the start reading.');
                    return;
                }

                const distance = end - start;
                trips.push({ date, purpose, start, end, distance });
                localStorage.setItem('mileageTrips', JSON.stringify(trips));
                renderTrips();
                tripForm.reset();
            });

            monthlyForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const month = document.getElementById('month').value;
                const start = parseInt(document.getElementById('monthlyStartOdometer').value);
                const end = parseInt(document.getElementById('monthlyEndOdometer').value);

                 if (end < start) {
                    alert('End odometer reading cannot be less than the start reading.');
                    return;
                }

                monthlyReadings.push({ month, start, end });
                localStorage.setItem('monthlyReadings', JSON.stringify(monthlyReadings));
                renderMonthlyReadings();
                monthlyForm.reset();
            });

            window.editTrip = (index) => {
                const trip = trips[index];
                const newPurpose = prompt('Enter new purpose:', trip.purpose);
                if (newPurpose) {
                    trips[index].purpose = newPurpose;
                    localStorage.setItem('mileageTrips', JSON.stringify(trips));
                    renderTrips();
                }
            };

            window.deleteTrip = (index) => {
                if (confirm('Are you sure you want to delete this trip?')) {
                    trips.splice(index, 1);
                    localStorage.setItem('mileageTrips', JSON.stringify(trips));
                    renderTrips();
                }
            };
            
            document.getElementById('export-pdf').addEventListener('click', () => {
                const element = document.getElementById('mileage-log');
                html2pdf(element);
            });

            renderTrips();
            renderMonthlyReadings();
        });
    </script>
</body>
</html>```
